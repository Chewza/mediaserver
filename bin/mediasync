#!/bin/bash
SOURCE=$1
DRYRUN=$2

if [ "$DRYRUN" = "dry" ]; then
	DRYRUNCMD="--dry-run"
	echo "Dry run initiated..."
fi

mysync()
{
	for path in $1; do
		sourcepath="${path%:*}"
		destpath="${path#*:}"
		[ -d "$destpath" ] || mkdir -p "$destpath"
		rsync -avz -e "ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null" --progress --delete $DRYRUNCMD $SOURCE:/$sourcepath $destpath/
	done
}

PATHS=
PATHS+=" /home/ubuntu/mediaserver/hydra/:/home/ubuntu/mediaserver/hydra/"
PATHS+=" /home/ubuntu/mediaserver/letsencrypt/:/home/ubuntu/mediaserver/letsencrypt/"
PATHS+=" /home/ubuntu/mediaserver/nzbget/:/home/ubuntu/mediaserver/nzbget/"
PATHS+=" /home/ubuntu/mediaserver/plexpy/:/home/ubuntu/mediaserver/plexpy/"
PATHS+=" /home/ubuntu/mediaserver/portainer/:/home/ubuntu/mediaserver/portainer/"
PATHS+=" /home/ubuntu/mediaserver/radarr/:/home/ubuntu/mediaserver/radarr/"
PATHS+=" /home/ubuntu/mediaserver/sonarr/:/home/ubuntu/mediaserver/sonarr/"
PATHS+=" /home/ubuntu/mediaserver/transmission/:/home/ubuntu/mediaserver/transmission/"
PATHS+=" /home/ubuntu/mediaserver/plex/:/home/ubuntu/mediaserver/plex/"
mysync "$PATHS"
